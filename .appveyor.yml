# set clone depth
clone_depth: 5                  # clone entire repository history if not defined

environment:
  matrix:
    - CYG_ARCH: x86
      CYG_ROOT: C:\cygwin
      TEST_SUITE: testinstall
    - CYG_ARCH: x86_64
      CYG_ROOT: C:\cygwin64
      TEST_SUITE: testinstall

cache:
  - bootstrap-pkg-full.tar.gz

install:
  - '%CYG_ROOT%\setup-%CYG_ARCH%.exe -qnNdO -R %CYG_ROOT% -s http://cygwin.mirror.constant.com -l %CYG_ROOT%/var/cache/setup -P libgmp-devel'

# scripts that run after cloning repository
build_script:
  - SET "PATH=%CYG_ROOT%\bin;%PATH%"
  - sed -i -e "s/wget/wget -nv/g" Makefile.in
  - bash -lc "cd $APPVEYOR_BUILD_FOLDER && ./configure --with-gmp=system"
  - bash -lc "make -C $APPVEYOR_BUILD_FOLDER cygwin"
  - bash -lc "make -C $APPVEYOR_BUILD_FOLDER bootstrap-pkg-full"

test_script:
  - bash -lc "cd $APPVEYOR_BUILD_FOLDER && ./etc/ci.sh"
