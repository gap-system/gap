##############################################################################
##
##    Makefile.in                     NQ                         Werner Nickel
##
##    $Id: Makefile.in,v 1.36 2012/01/16 13:55:49 gap Exp $
##

##
##    Values imported from the configure script
##
top_srcdir = @top_srcdir@
top_builddir = @top_builddir@
srcdir = @srcdir@
VPATH = @srcdir@
subdir = .

GAP_ROOT=@GAP_ROOT@
BINDIR=bin/@GAPARCH@

all: compile

gap: compile gapmanual

compile:
	(cd src; make)
	mkdir -p $(BINDIR)
	mv src/nq $(BINDIR)

gapmanual:
	cd doc; make

release-2.0:
	rm -rf nq-2.0
	cvs export -D 'February 11, 2003 11:00' -d nq-2.0 GAP/4.0/pkg/nq

	find nq-2.0 -name .cvsignore -exec rm "{}" ";"

	rm -f nq-2.0.tar.gz nq-2.0.tar.bz2
	tar czf nq-2.0.tar.gz nq-2.0
	tar cjf nq-2.0.tar.bz2 nq-2.0

release-2.1:
	rm -rf nq-2.1
	cvs export -D 'October 20, 2003 11:00' -d nq-2.1 GAP/4.0/pkg/nq

	find nq-2.1 -name .cvsignore -exec rm "{}" ";"

	cd nq-2.1/doc; make; make clean

	rm -f nq-2.1.tar.gz nq-2.1.tar.bz2
	tar czf nq-2.1.tar.gz nq-2.1
	tar cjf nq-2.1.tar.bz2 nq-2.1

release-2.2:
	rm -rf nq-2.2
	cvs export -D 'February 7, 2007 12:00' -d nq-2.2 GAP/4.0/pkg/nq

	find nq-2.2 -name .cvsignore -exec rm "{}" ";"

	cd nq-2.2/doc; make; make clean

	rm -f nq-2.2.tar.gz nq-2.2.tar.bz2
	tar czf nq-2.2.tar.gz nq-2.2
	tar cjf nq-2.2.tar.bz2 nq-2.2

release-2.3:
	rm -rf nq-2.3
	cvs export -D 'September 15, 2011 20:30' -d nq-2.3 GAP/4.0/pkg/nq

	find nq-2.3 -name .cvsignore -exec rm "{}" ";"

	# TODO: Insert code which (re-)generates the docs without
	# having to run configure / without a Makefile
	# For example by having a makedoc script in there...

	rm -f nq-2.3.tar.gz nq-2.3.tar.bz2
	tar czf nq-2.3.tar.gz nq-2.3
	tar cjf nq-2.3.tar.bz2 nq-2.3

test:
	(cd examples; make)

clean:
	(cd src;      make clean)
	(cd doc;      make clean)
	(cd examples; make clean)

distclean: clean
	rm -f Makefile
	rm -rf bin
	rm -rf .\#*
	rm -f *~ */*~
	rm -rf nq-2.? nq-2_?.tar nq-2_?.tar.gz
	rm -f config.cache config.log config.status
	(cd src;      make distclean)
	(cd doc;      make distclean)
	(cd examples; make distclean)


.PRECIOUS: Makefile
Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status
	cd $(top_builddir) && $(SHELL) ./config.status $@

$(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
	$(SHELL) ./config.status --recheck

$(top_srcdir)/configure: $(top_srcdir)/configure.in
	cd $(top_srcdir) && autoreconf

.PHONY: all gap compile gapmanual WWW test clean distclean
